import java.net.*;import java.io.*;import java.util.*;import java.util.concurrent.Semaphore;/*Classe du serveur qui va recevoir les demandes de connection*/public class PokerServer {			static Vector clientList= new Vector();	static Vector partiesList = new Vector();	static PrintWriter screenOut = new PrintWriter(System.out, true);	static ServerSocket serverSocket = null;	static Semaphore available = new Semaphore(1, true);	static Semaphore availableP = new Semaphore(1, true);	static Runtime rtim = Runtime.getRuntime();		public static void main(String[] args) throws IOException {			boolean listening = true;		CommandReader tempCommand;		Thread tempThread;		PokerClientThread tempClient;		int currentNode;		Integer tempPort;		screenOut.println("");screenOut.println("");		screenOut.println("POKER Server v0.1");		screenOut.println("------------------------------------------------------");		screenOut.println(" Notes:");		screenOut.println("Tapez 'HELP' pour voir les commandes");		screenOut.println("------------------------------------------------------");		screenOut.println("");		// on prend le port en argument ou 6667 par défault				if  (args.length >= 1){			 tempPort = new Integer(args[0]);										}					else								{								tempPort = 6667;								}						try{				serverSocket = new ServerSocket(tempPort.intValue());			}catch(IOException e){				System.err.println("Erreur de port "+tempPort);				System.exit(-1);			}																				screenOut.println("Le serveur ecoute le port "+tempPort+"\n");				screenOut.print(">");				screenOut.flush();				tempCommand = new CommandReader();				tempCommand.start();							while (listening){				try{													tempClient = new PokerClientThread(serverSocket.accept());					clientList.add(tempClient);					tempThread = new Thread(tempClient);					tempThread.start();						screenOut.println("Nouveau client");				}				catch (IOException e){e.printStackTrace();				}			}			serverSocket.close();			}				/*		Fonction pour lister les parties		*/	static void listParties(){		PokerPartie foo;		for (int i=0;i<partiesList.size();++i){			foo = (PokerPartie)partiesList.get(i);			screenOut.println(" Partie "+(i+1)+": "+foo.getEtat());		} 		}			/*		Fonction pour lister les clients		*/	static void listClients(){		PokerClientThread foo;		for (int i=0;i<clientList.size();++i){			foo = (PokerClientThread)clientList.get(i);			screenOut.println(" Client "+(i+1)+": "+foo.getClientIP());		} 		}			/*		Fonction pour enlever un client de la liste		*/	static void deleteClient(PokerClientThread deadClient){	try{		available.acquire();		int num;		num=clientList.indexOf(deadClient);		if(num!=-1){		deadClient = null;		 rtim.gc(); // appel au garbage collector		clientList.remove(num);		screenOut.println("ya un client qui deco");					}	available.release();	}catch(Exception e){e.printStackTrace();}  }  		/*		Fonction pour enlever une partie de la liste		*/  static void deletePartie(PokerPartie deadPartie){	try{		availableP.acquire();		int num;		num=partiesList.indexOf(deadPartie);		if(num!=-1){		 deadPartie = null;		 rtim.gc(); // appel au garbage collector		partiesList.remove(num);		screenOut.println("ya une partie qui est détruite");					}	availableP.release();	}catch(Exception e){e.printStackTrace();}  }   /* Creation d'une nouvelle partie */static void creerPartie(PokerClientThread premClient,String nomP,int maxP){int existe = 0;PokerPartie p1;		for (int i=0;i<PokerServer.partiesList.size();++i){			p1 = (PokerPartie)PokerServer.partiesList.get(i);			if(p1.getNom().equals(nomP)){existe=1;break;}		}		if(existe==0){	 p1 = new PokerPartie(nomP,maxP);	p1.getClientList().add(premClient);	partiesList.add(p1);}	else{premClient.send("nom partie existe deja");}											}											  /*  Fonction pour creer le string à envoyer au clients qui veulent connaitre les parties en cours  */  static String listClientParties(){			String s="<>";		PokerPartie foo;		for (int i=0;i<partiesList.size();++i){			foo = (PokerPartie)partiesList.get(i);			s+="<partie>"+foo.getNom()+"<joueurs>"+foo.getNbJ()+"/"+foo.getMaxPlayers()+"<>";		} 		return s;									}    }